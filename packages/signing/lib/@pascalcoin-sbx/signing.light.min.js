!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@pascalcoin-sbx/common"),require("@pascalcoin-sbx/crypto")):"function"==typeof define&&define.amd?define("@pascalcoin-sbx/signing",["@pascalcoin-sbx/common","@pascalcoin-sbx/crypto"],e):"object"==typeof exports?exports["@pascalcoin-sbx/signing"]=e(require("@pascalcoin-sbx/common"),require("@pascalcoin-sbx/crypto")):t["@pascalcoin-sbx/signing"]=e(t["@pascalcoin-sbx/common"],t["@pascalcoin-sbx/crypto"])}("undefined"!=typeof self?self:this,function(t,e){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=13)}([function(e,i){e.exports=t},function(t,e,i){const n=i(3),s=i(0).BC,r=i(0).Types.Currency,o=i(0).PascalCoinInfo,c=Symbol("payload"),a=Symbol("s"),d=Symbol("r"),h=Symbol("fee"),l=Symbol("nOperation"),u=Symbol("raw_coder"),p=Symbol("digest_coder");t.exports=class{constructor(t,e){this[c]=s.fromString(""),this[a]=null,this[d]=null,this[h]=new r(0),this[p]=t,this[u]=e}withPayload(t){return this[c]=t,this}withFee(t){return this[h]=new r(t),this}withMinFee(t=null){return this[h]=o.MIN_FEE(t),this}digest(){return this[p].encodeToBytes(this)}sign(t,e,i=!1){this[l]=e;const s=this.digest();let r;return r=!0===i?n.signWithDigest(t,s):n.signWithHash(t,s),this[d]=r.r,this[a]=r.s,this}toRaw(){return this[u].encodeToBytes(this)}toRawDebug(){return this[u].encodeToBytes(this,!0)}static fromRaw(){throw new Error("Not implemented")}bcFromInt(t,e=null){return(null===e?s.fromInt(t):s.fromInt(t,e)).switchEndian()}bcFromStringWithSize(t){return s.concat(this.bcFromInt(t.length,2),this.bcFromString(t))}bcFromBcWithSize(t){return s.concat(this.bcFromInt(t.length,2),t)}static readBCWithSize(t,e){const i={size:t.slice(e,e+2).switchEndian().toInt()};return i.value=t.slice(e+2,e+2+i.size),i}bcFromString(t){return s.fromString(t)}bcFromSign(t,e){return s.concat(this.bcFromBcWithSize(t),this.bcFromBcWithSize(e))}get payload(){return this[c]}get r(){return this[d]}get s(){return this[a]}get fee(){return this[h]}get nOperation(){return this[l]}get isSigned(){return null!==this[a]&&null!==this[d]}}},function(t,e,i){const n=i(0).Coding.AbstractType,s=i(0).BC,r=Symbol("size");t.exports=class extends n{decodeFromBytes(t){return t}encodeToBytes(t){return this[r]=s.from(t).length,s.from(t)}get size(){return this[r]}}},function(t,e,i){"use strict";const n=i(0).Sha,s=i(16).Keys;t.exports=class{static signWithHash(t,e){const i=n.sha256(e);return s.sign(t,i)}static signWithDigest(t,e){return s.sign(t,e)}}},function(t,e,i){const n=i(0).Coding.Pascal.Keys.PublicKey,s=i(0).Coding.Core.VariableString,r=i(0).Types.Keys.PublicKey,o=new n;t.exports=class extends s{constructor(t=null){super(t||"pubkey")}decodeFromBytes(t){const e=super.decodeFromBytes(t),i=o.decodeFromBytes(e);return new r(i.x,i.y,i.curve)}encodeToBytes(t){return super.encodeToBytes(o.encodeToBytes(t))}}},function(t,e,i){const n=i(0).Coding,s=i(0).Endian,r=n.CompositeType;t.exports=class extends r{constructor(t){super("data_operation_raw"),this.addField(new n.Pascal.OpType(4).setFixedValue(t)),this.addField(new n.Pascal.AccountNumber("signer")),this.addField(new n.Pascal.AccountNumber("sender")),this.addField(new n.Pascal.AccountNumber("target")),this.addField(new n.Pascal.NOperation),this.addField(new n.Core.Int16("dataType",!0,s.LITTLE_ENDIAN)),this.addField(new n.Core.Int16("dataSequence",!0,s.LITTLE_ENDIAN)),this.addField(new n.Pascal.Currency("amount")),this.addField(new n.Pascal.Currency("fee")),this.addField(new n.Core.VariableString("payload")),this.addField(new n.Core.VariableString("r")),this.addField(new n.Core.VariableString("s"))}}},function(t,e,i){const n=i(0).Coding,s=i(0).Endian,r=n.CompositeType;t.exports=class extends r{constructor(t){super("data_operation_digest"),this.addField(new n.Pascal.AccountNumber("signer")),this.addField(new n.Pascal.AccountNumber("sender")),this.addField(new n.Pascal.AccountNumber("target")),this.addField(new n.Pascal.NOperation),this.addField(new n.Core.Int16("dataType",!0,s.LITTLE_ENDIAN)),this.addField(new n.Core.Int16("dataSequence",!0,s.LITTLE_ENDIAN)),this.addField(new n.Pascal.Currency("amount")),this.addField(new n.Pascal.Currency("fee")),this.addField(new n.Core.VariableString("payload")),this.addField(new n.Pascal.OpType(1).setFixedValue(t))}}},function(t,e,i){const n=i(0).Coding,s=i(0).Types.Keys.PublicKey,r=n.CompositeType;t.exports=class extends r{constructor(t){super("data_operation_raw"),this.addField(new n.Pascal.OpType(4).setFixedValue(t)),this.addField(new n.Pascal.AccountNumber("sender")),this.addField(new n.Pascal.NOperation("nOperation")),this.addField(new n.Pascal.AccountNumber("target")),this.addField(new n.Pascal.Currency("amount")),this.addField(new n.Pascal.Currency("fee")),this.addField(new n.Core.VariableString("payload")),this.addField(new n.Pascal.Keys.PublicKey("v2_pubkey").setFixedValue(s.empty())),this.addField(new n.Core.VariableString("r")),this.addField(new n.Core.VariableString("s"))}}},function(t,e,i){const n=i(0).Coding,s=i(0).Types.Keys.PublicKey,r=n.CompositeType,o=i(2);t.exports=class extends r{constructor(t){super("tx_operation_digest"),this.addField(new n.Pascal.AccountNumber("sender")),this.addField(new n.Pascal.NOperation("nOperation")),this.addField(new n.Pascal.AccountNumber("target")),this.addField(new n.Pascal.Currency("amount")),this.addField(new n.Pascal.Currency("fee")),this.addField(new o("payload")),this.addField(new n.Pascal.Keys.Curve("v2_pubkey_curve").setFixedValue(s.empty().curve)),this.addField(new n.Pascal.OpType(1).setFixedValue(t))}}},function(t,e,i){const n=i(0).Types.Keys.PublicKey,s=i(0).Coding,r=i(0).Endian,o=i(4),c=s.CompositeType;t.exports=class extends c{constructor(t){super("list_operation_raw"),this.addField(new s.Pascal.OpType(4).setFixedValue(t)),this.addField(new s.Pascal.AccountNumber("signer")),this.addField(new s.Pascal.AccountNumber("target")),this.addField(new s.Pascal.OpType(2).setFixedValue(t)),this.addField(new s.Pascal.NOperation),this.addField(new s.Pascal.Currency("price")),this.addField(new s.Pascal.AccountNumber("accountToPay")),this.addField(new s.Pascal.Keys.PublicKey("v2_pubkey").setFixedValue(n.empty())),this.addField(new o("newPublicKey")),this.addField(new s.Core.Int32("lockedUntilBlock",!0,r.LITTLE_ENDIAN)),this.addField(new s.Pascal.Currency("fee")),this.addField(new s.Core.VariableString("payload")),this.addField(new s.Core.VariableString("r")),this.addField(new s.Core.VariableString("s"))}}},function(t,e,i){const n=i(0).Coding,s=i(0).Types.Keys.PublicKey,r=n.CompositeType,o=i(2);t.exports=class extends r{constructor(t){super("data_operation_digest"),this.addField(new n.Pascal.AccountNumber("signer")),this.addField(new n.Pascal.AccountNumber("target")),this.addField(new n.Pascal.NOperation),this.addField(new n.Pascal.Currency("price")),this.addField(new n.Pascal.AccountNumber("accountToPay")),this.addField(new n.Pascal.Currency("fee")),this.addField(new o("payload")),this.addField(new n.Pascal.Keys.Curve("v2_pubkey_curve").setFixedValue(s.empty().curve)),this.addField(new n.Pascal.Keys.PublicKey("newPublicKey")),this.addField(new n.Core.Int32("lockedUntilBlock")),this.addField(new n.Pascal.OpType(1).setFixedValue(t))}}},function(t,e,i){const n=i(0).Coding,s=n.CompositeType;t.exports=class extends s{constructor(t){super("delist_operation_raw"),this.addField(new n.Pascal.OpType(4).setFixedValue(t)),this.addField(new n.Pascal.AccountNumber("signer")),this.addField(new n.Pascal.AccountNumber("target")),this.addField(new n.Pascal.OpType(2).setFixedValue(t)),this.addField(new n.Pascal.NOperation),this.addField(new n.Pascal.Currency("fee")),this.addField(new n.Core.VariableString("payload")),this.addField(new n.Core.VariableString("r")),this.addField(new n.Core.VariableString("s"))}}},function(t,e,i){const n=i(0).Coding,s=i(0).Types.Keys.PublicKey,r=n.CompositeType,o=i(2);t.exports=class extends r{constructor(t){super("delist_operation_digest"),this.addField(new n.Pascal.AccountNumber("signer")),this.addField(new n.Pascal.AccountNumber("target")),this.addField(new n.Pascal.NOperation),this.addField(new n.Pascal.Currency("price")),this.addField(new n.Pascal.AccountNumber("accountToPay")),this.addField(new n.Pascal.Currency("fee")),this.addField(new o("payload")),this.addField(new n.Pascal.Keys.Curve("v2_pubkey_curve").setFixedValue(s.empty().curve)),this.addField(new n.Pascal.Keys.PublicKey("newPublicKey")),this.addField(new n.Core.Int32("lockedUntilBlock")),this.addField(new n.Pascal.OpType(1).setFixedValue(t))}}},function(t,e,i){t.exports=i(14)},function(t,e,i){t.exports={OperationsBuilder:i(15),Signer:i(3),Coding:{PublicKeyWithLength:i(4),StringWithoutLength:i(2)},Operations:i(17)}},function(t,e,i){const n=i(0).BC,s=Symbol("operations");t.exports=class{constructor(){this[s]=[]}addOperation(t){if(!t.isSigned)throw new Error("Operation needs to be signed.");return this[s].push(t),this}build(){let t=n.fromInt(this[s].length,4).switchEndian();return this[s].forEach(e=>{t=n.concat(t,e.toRaw())}),t}parse(t){let e=n.fromInt(this[s].length,4).switchEndian();return this[s].forEach(t=>{e=n.concat(e,t.toRaw())}),e}}},function(t,i){t.exports=e},function(t,e,i){t.exports={BuyAccount:i(18),ChangeAccountInfo:i(19),ChangeKey:i(20),ChangeKeySigned:i(21),Data:{Operation:i(22),RawCoder:i(5),DigestCoder:i(6)},Transaction:{Operation:i(23),RawCoder:i(7),DigestCoder:i(8)},ListAccountForSale:{Operation:i(24),RawCoder:i(9),DigestCoder:i(10)},DeListAccountForSale:{Operation:i(25),RawCoder:i(11),DigestCoder:i(12)}}},function(t,e,i){const n=i(1),s=i(0).BC,r=i(0).Types.Keys.PublicKey,o=i(0).Types.Currency,c=i(0).Types.AccountNumber,a=Symbol("sender"),d=Symbol("target"),h=Symbol("amount"),l=Symbol("price"),u=Symbol("seller"),p=Symbol("new_public_key");class y extends n{static get OPTYPE(){return 6}constructor(t,e,i,n,s,r){super(),this[a]=new c(t),this[d]=new c(e),this[h]=new o(i),this[l]=new o(n),this[u]=new c(s),this[p]=r}digest(){return s.concat(this.bcFromInt(this[a].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this[d].account,4),this.bcFromInt(this[h].toMolina(),8),this.bcFromInt(this.fee.toMolina(),8),this.payload,this.bcFromInt(r.empty().curve.id,2),this.bcFromInt(this[l].toMolina(),8),this.bcFromInt(this[u].account,4),this[p].encode(),s.fromInt(y.OPTYPE))}toRaw(){return s.concat(this.bcFromInt(y.OPTYPE,4),this.bcFromInt(this[a].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this[d].account,4),this.bcFromInt(this[h].toMolina(),8),this.bcFromInt(this.fee.toMolina(),8),this.bcFromBcWithSize(this.payload),r.empty().encode(),this.bcFromInt(2,1),this.bcFromInt(this[l].toMolina(),8),this.bcFromInt(this[u].account,4),this[p].encode(),this.bcFromSign(this.r,this.s))}static fromRaw(t){}}t.exports=y},function(t,e,i){const n=i(1),s=i(0).BC,r=i(0).Types.Keys.PublicKey,o=i(0).Types.AccountNumber,c=i(0).Types.AccountName,a=Symbol("account_signer"),d=Symbol("account_target"),h=Symbol("new_public_key"),l=Symbol("new_name"),u=Symbol("new_type"),p=Symbol("with_new_pubkey"),y=Symbol("with_new_name"),b=Symbol("with_new_type");function m(t){let e=0;return!0===t[p]&&(e|=1),!0===t[y]&&(e|=2),!0===t[b]&&(e|=4),e}class F extends n{static get OPTYPE(){return 8}constructor(t,e){super(),this[a]=new o(t),this[d]=new o(e),this[h]=r.empty(),this[l]=s.fromString(""),this[u]=0,this[p]=!1,this[y]=!1,this[b]=!1}withNewPublicKey(t){return this[h]=t,this[p]=!0,this}withNewName(t){return this[l]=new c(t),this[y]=!0,this}withNewType(t){return this[u]=t,this[b]=!0,this}digest(){return s.concat(this.bcFromInt(this[a].account,4),this.bcFromInt(this[d].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this.fee.toMolina(),8),this.bcFromBcWithSize(this.payload),r.empty().encode(),this.bcFromInt(m(this)),this[h].encode(),this.bcFromBcWithSize(s.fromString(this[l].toString())),this.bcFromInt(this[u],2),this.bcFromInt(F.OPTYPE))}toRaw(){return s.concat(this.bcFromInt(F.OPTYPE,4),this.bcFromInt(this[a].account,4),this.bcFromInt(this[d].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this.fee.toMolina(),8),this.bcFromBcWithSize(this.payload),r.empty().encode(),this.bcFromInt(m(this)),this[h].encode(),this.bcFromBcWithSize(s.fromString(this[l].toString())),this.bcFromInt(this[u],2),this.bcFromSign(this.r,this.s))}}t.exports=F},function(t,e,i){const n=i(1),s=i(0).BC,r=i(0).Types.Keys.PublicKey,o=i(0).Types.AccountNumber,c=Symbol("account_signer"),a=Symbol("new_public_key");class d extends n{static get OPTYPE(){return 2}constructor(t,e){super(),this[c]=new o(t),this[a]=e}digest(){return s.concat(this.bcFromInt(this[c].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this.fee.toMolina(),8),this.payload,this.bcFromInt(r.empty().curve.id,2),this[a].encode(),this.bcFromInt(d.OPTYPE))}toRaw(){return s.concat(this.bcFromInt(d.OPTYPE,4),this.bcFromInt(this[c].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this.fee.toMolina(),8),this.bcFromBcWithSize(this.payload),r.empty().encode(),this.bcFromInt(this[a].encode().length,2),this[a].encode(),this.bcFromSign(this.r,this.s))}}t.exports=d},function(t,e,i){const n=i(1),s=i(0).BC,r=i(0).Types.Keys.PublicKey,o=i(0).Types.AccountNumber,c=Symbol("account_signer"),a=Symbol("account_target"),d=Symbol("new_public_key");class h extends n{static get OPTYPE(){return 7}constructor(t,e,i){super(),this[c]=new o(t),this[a]=new o(e),this[d]=i}digest(){return s.concat(this.bcFromInt(this[c].account,4),this.bcFromInt(this[a].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this.fee.toMolina(),8),this.payload,this.bcFromInt(r.empty().curve.id,2),this[d].encode(),this.bcFromInt(h.OPTYPE))}toRaw(){return s.concat(this.bcFromInt(h.OPTYPE,4),this.bcFromInt(this[c].account,4),this.bcFromInt(this[a].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this.fee.toMolina(),8),this.bcFromBcWithSize(this.payload),r.empty().encode(),this.bcFromInt(this[d].encode().length,2),this[d].encode(),this.bcFromSign(this.r,this.s))}}t.exports=h},function(t,e,i){const n=i(1),s=i(0).Types.AccountNumber,r=i(0).Types.Currency,o=i(5),c=i(6),a=Symbol("account_signer"),d=Symbol("account_sender"),h=Symbol("account_target"),l=Symbol("data_type"),u=Symbol("data_sequence"),p=Symbol("amount");class y extends n{static get OPTYPE(){return 10}constructor(t,e,i){super(new c(y.OPTYPE),new o(y.OPTYPE)),this[a]=new s(t),this[d]=new s(e),this[h]=new s(i),this[l]=0,this[u]=0,this[p]=new r(0)}withDataType(t){return this[l]=parseInt(t,10),this}withDataSequence(t){return this[u]=parseInt(t,10),this}withAmount(t){return this[p]=new r(t),this}get signer(){return this[a]}get sender(){return this[d]}get target(){return this[h]}get dataType(){return this[l]}get dataSequence(){return this[u]}get amount(){return this[p]}sign(t,e){super.sign(t,e,!0)}}t.exports=y},function(t,e,i){const n=i(1),s=i(0).Types.Currency,r=i(0).Types.AccountNumber,o=i(7),c=i(8),a=Symbol("sender"),d=Symbol("target"),h=Symbol("amount");class l extends n{static get OPTYPE(){return 1}get sender(){return this[a]}get target(){return this[d]}get amount(){return this[h]}constructor(t,e,i){super(new c(l.OPTYPE),new o(l.OPTYPE)),this[a]=new r(t),this[d]=new r(e),this[h]=new s(i)}}t.exports=l},function(t,e,i){const n=i(1),s=i(0).BC,r=i(0).Types.Keys.PublicKey,o=i(0).Types.AccountNumber,c=i(0).Types.Currency,a=i(9),d=i(10),h=Symbol("account_signer"),l=Symbol("account_target"),u=Symbol("price"),p=Symbol("account_to_pay"),y=Symbol("new_public_key"),b=Symbol("locked_until_block");class m extends n{static get OPTYPE(){return 4}constructor(t,e,i,n){super(new d(m.OPTYPE),new a(m.OPTYPE)),this[h]=new o(t),this[l]=new o(e),this[u]=new c(i),this[p]=new o(n),this[y]=r.empty(),this[b]=0}get signer(){return this[h]}get target(){return this[l]}get price(){return this[u]}get accountToPay(){return this[p]}get newPublicKey(){return this[y]}get lockedUntilBlock(){return this[b]}asPrivateSale(t,e=0){this[y]=t,this[b]=parseInt(e,10)}digest2(){return s.concat(this.bcFromInt(this[h].account,4),this.bcFromInt(this[l].account,4),this.bcFromInt(this.nOperation,4),this.bcFromInt(this[u].toMolina(),8),this.bcFromInt(this[p].account,4),this.bcFromInt(this.fee.toMolina(),8),this.payload,this.bcFromInt(r.empty().curve.id,2),this.bcFromInt(this[b],4),this.bcFromInt(m.OPTYPE))}toRaw2(){return s.concat(this.bcFromInt(m.OPTYPE,4),this.bcFromInt(this[h].account,4),this.bcFromInt(this[l].account,4),this.bcFromInt(4,2),this.bcFromInt(this.nOperation,4),this.bcFromInt(this[u].toMolina(),8),this.bcFromInt(this[p].account,4),this.bcFromInt(r.empty().curve.id,2),this.bcFromInt(0,2),this.bcFromInt(0,2),this.bcFromInt(this[y].encode().length,2),this[y].encode(),this.bcFromInt(this[b],4),this.bcFromInt(this.fee.toMolina(),8),this.bcFromBcWithSize(this.payload),this.bcFromSign(this.r,this.s))}}t.exports=m},function(t,e,i){const n=i(1),s=i(0).Types.Keys.PublicKey,r=i(0).Types.AccountNumber,o=i(0).Types.Currency,c=i(11),a=i(12),d=Symbol("account_signer"),h=Symbol("account_target"),l=Symbol("price"),u=Symbol("account_to_pay"),p=Symbol("new_public_key"),y=Symbol("locked_until_block");class b extends n{static get OPTYPE(){return 5}constructor(t,e){super(new a(b.OPTYPE),new c(b.OPTYPE)),this[d]=new r(t),this[h]=new r(e),this[l]=new o(0),this[u]=new r(0),this[p]=s.empty(),this[y]=0}get signer(){return this[d]}get target(){return this[h]}get price(){return this[l]}get accountToPay(){return this[u]}get newPublicKey(){return this[p]}get lockedUntilBlock(){return this[y]}}t.exports=b}])});
//# sourceMappingURL=signing.light.min.js.map